if [ "$SEINJECT" != "/sbin/sepolicy-inject" ]; then
  $SEINJECT --live "create dtshpxservice_service dts_data_file dtshpxservice dtshpxservice_tmpfs dtshpx_app dtshpx_app_tmpfs dtshpx_app_devpts dtshpxservice_exec dtsconfigurator_exec dtsconfigurator dtsconfigurator_tmpfs dtseagleservice_exec dtseagleservice dtseagleservice_tmpfs dtseagleservice_service self oem_prop oem_device AW_file untrusted_app_25" "allow audioserver dtshpxservice_service service_manager find" "allow audioserver dts_data_file dir { ioctl read write getattr lock add_name remove_name search open }" "allow audioserver dts_data_file file { ioctl read write create getattr setattr lock append unlink rename open }" "allow audioserver dts_data_file file { read getattr open }" "allow audioserver dts_data_file dir { write add_name }" "allow audioserver dts_data_file file { write create setattr open }" "allow audioserver dtshpxservice binder call" "typetrans dtshpx_app tmpfs file dtshpx_app_tmpfs" "allow dtshpx_app dtshpx_app_tmpfs file { read write getattr }" "allow dtshpx_app tmpfs dir { getattr search }" "allow dtshpx_app dtshpx_app_tmpfs file execute" "typetrans dtshpx_app devpts chr_file dtshpx_app_devpts" "allow dtshpx_app dtshpx_app_devpts chr_file { ioctl read write getattr open }" "allow dtshpx_app asec_apk_file file { ioctl read getattr lock open }" "allow dtshpx_app asec_apk_file dir { ioctl read getattr lock search open }" "allow dtshpx_app shell_data_file file { ioctl read getattr lock open }" "allow dtshpx_app shell_data_file dir { ioctl read getattr lock search open }" "allow dtshpx_app app_data_file file { read write getattr }" "allow dtshpx_app media_rw_data_file dir { ioctl read write create getattr setattr lock rename add_name remove_name reparent search rmdir open }" "allow dtshpx_app media_rw_data_file file { ioctl read write create getattr setattr lock append unlink rename open }" "allow dtshpx_app mnt_media_rw_file dir search" "allow dtshpx_app servicemanager service_manager list" "allow dtshpx_app audioserver_service service_manager find" "allow dtshpx_app cameraserver_service service_manager find" "allow dtshpx_app drmserver_service service_manager find" "allow dtshpx_app mediaserver_service service_manager find" "allow dtshpx_app mediaextractor_service service_manager find" "allow dtshpx_app mediacodec_service service_manager find" "allow dtshpx_app mediametrics_service service_manager find" "allow dtshpx_app mediadrmserver_service service_manager find" "allow dtshpx_app mediacasserver_service service_manager find" "allow dtshpx_app nfc_service service_manager find" "allow dtshpx_app radio_service service_manager find" "allow dtshpx_app surfaceflinger_service service_manager find" "allow dtshpx_app app_api_service service_manager find" "allow dtshpx_app vr_manager_service service_manager find" "allow dtshpx_app dtshpx_app process ptrace" "allow dtshpx_app sysfs_hwrandom dir search" "allow dtshpx_app sysfs_hwrandom file { ioctl read getattr lock open }" "allow dtshpx_app preloads_media_file dir { ioctl read getattr lock search open }" "allow dtshpx_app preloads_media_file file { ioctl read getattr lock open }" "allow dtshpx_app preloads_data_file dir search" "allow dtshpx_app vendor_app_file dir { read getattr search open }" "allow dtshpx_app vendor_app_file file { read getattr execute open }" "allow dtshpx_app vendor_app_file lnk_file { read getattr open }" "allow dtshpx_app dtshpxservice_service service_manager find" "allow dtshpx_app dtshpxservice_service binder call" "allow dtshpx_app dts_data_file dir { ioctl read getattr lock search open }" "allow dtshpx_app dts_data_file file { ioctl read getattr lock open }" "allow dtshpx_app dtshpx_app udp_socket { create connect }" "allow dtshpx_app dtshpx_app tcp_socket { read write create getattr connect getopt setopt }" "allow dtshpx_app port tcp_socket name_connect" "allow dtshpx_app netd unix_stream_socket connectto" "allow dtshpx_app fwmarkd_socket sock_file write" "allow dtshpx_app dnsproxyd_socket sock_file write" "allow init dtshpxservice_exec file { read getattr execute open }" "allow init dtshpxservice process transition" "allow dtshpxservice dtshpxservice_exec file { read getattr execute entrypoint open }" "auditdeny init dtshpxservice process noatsecure" "allow init dtshpxservice process { siginh rlimitinh }" "typetrans init dtshpxservice_exec process dtshpxservice" "typetrans dtshpxservice tmpfs file dtshpxservice_tmpfs" "allow dtshpxservice dtshpxservice_tmpfs file { read write getattr }" "allow dtshpxservice tmpfs dir { getattr search }" "allow dtshpxservice servicemanager binder { call transfer }" "allow servicemanager dtshpxservice dir search" "allow servicemanager dtshpxservice file { read open }" "allow servicemanager dtshpxservice process getattr" "allow dtshpxservice platform_app binder { call transfer }" "allow platform_app dtshpxservice binder transfer" "allow dtshpxservice platform_app fd use" "allow dtshpxservice priv_app binder { call transfer }" "allow priv_app dtshpxservice binder transfer" "allow dtshpxservice priv_app fd use" "allow dtshpxservice dtshpxservice_service service_manager add" "allow dtshpxservice audio_device chr_file { ioctl read write getattr lock append open }" "allow dtshpxservice audio_device dir { ioctl read getattr lock search open }" "allow dtshpxservice dts_data_file dir { ioctl read write getattr lock add_name remove_name search open }" "allow dtshpxservice dts_data_file file { ioctl read write create getattr setattr lock append unlink rename open }" "allow dtshpxservice audioserver_service service_manager find" "allow dtshpxservice audioserver binder { call transfer }" "allow audioserver dtshpxservice binder transfer" "allow dtshpxservice audioserver fd use" "allow dtshpxservice mediaserver_service service_manager find" "allow dtshpxservice mediaserver binder { call transfer }" "allow mediaserver dtshpxservice binder transfer" "allow dtshpxservice mediaserver fd use" "allow dtshpxservice permission_service service_manager find" "allow dtshpxservice system_server binder { call transfer }" "allow system_server dtshpxservice binder transfer" "allow dtshpxservice system_server fd use" "allow dtshpxservice rootfs lnk_file getattr" "allow dtshpxservice sysfs dir { read open }" "allow dtshpxservice sysfs file { read getattr open }" "allow dtshpxservice binder_device chr_file { read write }" "allow dtshpxservice vendor_file file { read getattr execute open }" "allow dtshpxservice sysfs dir open" "allow platform_app dts_data_file dir search" "allow platform_app dtshpxservice_service service_manager find" "allow platform_app dts_data_file file read" "allow mediacodec dts_data_file dir { ioctl read write getattr lock add_name remove_name search open }" "allow mediacodec dts_data_file file { ioctl read write create getattr setattr lock append unlink rename open }" "allow mediaserver dtshpxservice_service service_manager find" "allow netd dtshpx_app fd use" "allow netd dtshpx_app tcp_socket { read write getopt setopt }" "allow init dtsconfigurator_exec file { read getattr execute open }" "allow init dtsconfigurator process transition" "allow dtsconfigurator dtsconfigurator_exec file { read getattr execute entrypoint open }" "auditdeny init dtsconfigurator process noatsecure" "allow init dtsconfigurator process { siginh rlimitinh }" "typetrans init dtsconfigurator_exec process dtsconfigurator" "typetrans dtsconfigurator tmpfs file dtsconfigurator_tmpfs" "allow dtsconfigurator dtsconfigurator_tmpfs file { read write getattr }" "allow dtsconfigurator tmpfs dir { getattr search }" "allow dtsconfigurator audio_device dir { ioctl read getattr lock search open }" "allow dtsconfigurator audio_device chr_file { ioctl read write getattr lock append open }" "allow init dtseagleservice_exec file { read getattr execute open }" "allow init dtseagleservice process transition" "allow dtseagleservice dtseagleservice_exec file { read getattr execute entrypoint open }" "auditdeny init dtseagleservice process noatsecure" "allow init dtseagleservice process { siginh rlimitinh }" "typetrans init dtseagleservice_exec process dtseagleservice" "typetrans dtseagleservice tmpfs file dtseagleservice_tmpfs" "allow dtseagleservice dtseagleservice_tmpfs file { read write getattr }" "allow dtseagleservice tmpfs dir { getattr search }" "allow dtseagleservice platform_app binder { call transfer }" "allow platform_app dtseagleservice binder transfer" "allow dtseagleservice platform_app fd use" "allow dtseagleservice priv_app binder { call transfer }" "allow priv_app dtseagleservice binder transfer" "allow dtseagleservice priv_app fd use" "allow dtseagleservice dtseagleservice_service service_manager add" "allow dtseagleservice audio_device dir { ioctl read getattr lock search open }" "allow dtseagleservice audio_device chr_file { ioctl read write getattr lock append open }" "allow mediaserver dts_data_file dir { ioctl read write getattr lock add_name remove_name search open }" "allow mediaserver dts_data_file file { ioctl read write create getattr setattr lock append unlink rename open }" "allow platform_app dtseagleservice binder { call transfer }" "allow dtseagleservice platform_app binder transfer" "allow platform_app dtseagleservice fd use" "allow priv_app dts_data_file dir { ioctl read getattr lock search open }" "allow  priv_app dts_data_file file { ioctl read getattr lock open }" "allow priv_app dts_data_file lnk_file { ioctl read getattr lock open }" "allow priv_app dtseagleservice binder { call transfer }" "allow dtseagleservice priv_app binder transfer" "allow priv_app dtseagleservice fd use" "allow priv_app default_android_service service_manager find" "allow priv_app hal_memtrack_hwservice hwservice_manager find" "allow hal_audio_default diag_device chr_file { read write }" "allow audioserver serialno_prop file { read open getattr }" "allow audioserver oem_prop file { read open getattr }" "allow init oem_device chr_file { read open }" "allow qti_init_shell default_prop property_service set" "allow priv_app ffs_prop property_service set" "allow priv_app device dir { read open }" "allow mediaextractor oem_prop file { read open getattr }" "allow priv_app property_socket sock_file write" "allow priv_app init unix_stream_socket connectto" "allow hal_perf_default sysfs file write" "allow init pdx_bufferhub_client_endpoint_socket_type unix_stream_socket { create bind }" "allow bufferhubd pdx_bufferhub_client_endpoint_socket_type unix_stream_socket { read write getattr setattr lock append listen accept getopt setopt shutdown }" "allow bufferhubd self process setsockcreate" "allow bufferhubd pdx_bufferhub_client_channel_socket_type unix_stream_socket { ioctl read write create getattr setattr lock append bind connect listen accept getopt setopt shutdown }" "allow bufferhubd pdx_performance_client_endpoint_dir_type dir { ioctl read getattr lock search open }" "allow bufferhubd pdx_performance_client_endpoint_socket_type sock_file { ioctl read write getattr lock append open }" "allow bufferhubd pdx_performance_client_endpoint_socket_type unix_stream_socket { read write shutdown connectto }" "allow bufferhubd pdx_performance_client_channel_socket_type unix_stream_socket { read write getattr setattr lock append getopt setopt shutdown }" "allow bufferhubd pdx_performance_client_server_type fd use" "allow pdx_performance_client_server_type bufferhubd fd use" "allow bufferhubd gpu_device chr_file { ioctl read write getattr lock append open }" "allow bufferhubd ion_device chr_file { ioctl read getattr lock open }" "allow bufferhubd mediacodec  fd use" "allow hal_allocator_client hal_allocator_server binder { call transfer}" "allow hal_allocator_server hal_allocator_client binder transfer" "allow hal_allocator_client hal_allocator_server fd use" "allow hal_allocator_server hidl_allocator_hwservice hwservice_manager { add find }" "allow hal_allocator_server hidl_base_hwservice hwservice_manager add" "allow hal_allocator_client hidl_allocator_hwservice hwservice_manager find" "allow hal_allocator_client hidl_memory_hwservice hwservice_manager find" "allow hal_audio_client hal_audio_server binder { call transfer }" "allow hal_audio_server hal_audio_client binder transfer" "allow hal_audio_client hal_audio_server fd use" "allow hal_audio_server hal_audio_client binder { call transfer }" "allow hal_audio_client hal_audio_server binder transfer" "allow hal_audio_server hal_audio_client fd use" "allow hal_audio_server hal_audio_hwservice hwservice_manager { add find }" "allow hal_audio_server hidl_base_hwservice hwservice_manager add" "allow hal_audio_client hal_audio_hwservice hwservice_manager find" "allow hal_audio ion_device chr_file { ioctl read getattr lock open }" "allow hal_audio proc dir { ioctl read getattr lock search open }" "allow hal_audio proc file { ioctl read getattr lock open }" "allow hal_audio proc lnk_file { ioctl read getattr lock open }" "allow hal_audio audio_device dir { ioctl read getattr lock search open }" "allow hal_audio audio_device chr_file { ioctl read write getattr lock append open }" "allow hal_audio shell fd use" "allow hal_audio shell fifo_file write" "allow hal_audio dumpstate fd use" "allow hal_audio dumpstate fifo_file write" "allow hal_bluetooth_client hal_bluetooth_server binder { call transfer }" "allow hal_bluetooth_server hal_bluetooth_client binder transfer" "allow hal_bluetooth_client hal_bluetooth_server fd use" "allow hal_bluetooth_server hal_bluetooth_client binder { call transfer }" "allow hal_bluetooth_client hal_bluetooth_server binder transfer" "allow hal_bluetooth_server hal_bluetooth_client fd use" "allow hal_bluetooth_server hal_bluetooth_hwservice hwservice_manager { add find }" "allow hal_bluetooth_server hidl_base_hwservice hwservice_manager add" "allow hal_bluetooth_client hal_bluetooth_hwservice hwservice_manager find" "allow hal_bluetooth sysfs_wake_lock file { ioctl read write getattr lock append open }" "allow hal_bluetooth self capability2 block_suspend" "allow hal_bluetooth self capability net_admin" "allow hal_bluetooth bluetooth_efs_file dir { ioctl read getattr lock search open }" "allow hal_bluetooth bluetooth_efs_file file { ioctl read getattr lock open }" "allow hal_bluetooth bluetooth_efs_file lnk_file { ioctl read getattr lock open }" "allow hal_bluetooth uhid_device chr_file { ioctl read write getattr lock append open }" "allow hal_bluetooth hci_attach_dev chr_file { ioctl read write getattr lock append open }" "allow hal_bluetooth sysfs_type dir { ioctl read getattr lock search open }" "allow hal_bluetooth sysfs_type file { ioctl read getattr lock open }" "allow hal_bluetooth sysfs_type lnk_file { ioctl read getattr lock open }" "allow hal_bluetooth sysfs_bluetooth_writable file { ioctl read write getattr lock append open }" "allow hal_bluetooth self capability2 wake_alarm" "allow hal_bluetooth property_socket sock_file write" "allow hal_bluetooth init unix_stream_socket connectto" "allow hal_bluetooth bluetooth_prop property_service set" "allow hal_bluetooth bluetooth_prop file { ioctl read getattr lock open }" "allow hal_bluetooth proc_bluetooth_writable file { ioctl read write getattr lock append open }" "allow hal_bluetooth self capability sys_nice" "allow priv_app dts_data_file dir {search read write}" "allow priv_app su binder call" "allow audioserver su binder call" "allow hal_audio_default dts_data_file dir search" "allow priv_app dts_data_file file { read write open getattr create }" "allow hal_audio_default dts_data_file dir write" "allow system_server audioserver file write" "allow system_server qti_debugfs dir search" "allow hal_audio_default dts_data_file dir add_name" "allow priv_app system_prop property_service set" "allow hal_audio_default dts_data_file file { create read write open unlink setattr }" "allow priv_app dtshpxservice_exec file getattr" "allow hal_drm_default oem_prop file getattr" "allow hal_perf_default kernel dir search" "allow priv_app opdiagnose_service service_manager find" "allow audioserver AW_file file { read write open }" "allow priv_app AW_file file { read open }" "allow priv_app AW_file file { read getattr open }" "allow priv_app proc_modules file { open read getattr }" "allow priv_app proc_interrupts file { open read }" "allow { audioserver hal_audio_default } { default_android_service audioserver_service } service_manager *" "allow { audioserver hal_audio_default priv_app servicemanager } { audio_data_file dts_data_file hal_audio_default system_data_file } dir *" "allow audioserver hal_broadcastradio_hwservice hwservice_manager *" "allow dts_data_file labeledfs filesystem *" "allow { hal_audio_default servicemanager } hal_audio_default process *" "allow hal_audio_default servicemanager binder *" "allow priv_app init unix_stream_socket *" "allow priv_app property_socket sock_file *" "allow priv_app system_prop property_service *" "permissive priv_app" "allow priv_app system_data_file file { open read }" "allow priv_app proc_stat file { read open getattr }" "allow hal_perf_default kernel dir { read open }" "allow hal_perf_default kernel file { ioctl read open write getattr lock }" "allow hal_memtrack_default qti_debugfs file { open read }" "allow priv_app unlabeled file { open read write getattr execute }" "allow untrusted_app unlabeled file { open read write getattr execute }" "allow system_server untrusted_app_25_devpts chr_file { read write }"

else
  $SEINJECT -Z audioserver -l
  $SEINJECT -Z hal_audio_default -l
  $SEINJECT -Z mediaserver -l
  $SEINJECT -Z priv_app -l
  $SEINJECT -Z servicemanager -l
  $SEINJECT -Z system_server -l
  $SEINJECT -Z dts_data_file -l  
fi

su -c killall dk.icepower.icesound
